<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ðŸ‡©ðŸ‡ª Germany | Nowcast EU Projection</title>

  <!-- Social preview -->
  <meta property="og:title" content="ðŸ‡©ðŸ‡ª Germany | Nowcast EU Projection">
  <meta property="og:image" content="https://nowcast-eu.github.io/Germany/thumbnail.png">
  <meta property="og:url" content="https://nowcast-eu.github.io/Germany/">
  <meta property="og:type" content="website">

  <link rel="icon" type="image/png" href="EU_favicon.png" />

  <style>
    html, body {
      margin: 0;
      padding: 0;
      font-family: system-ui, sans-serif;
      background: #fff;
    }

    /* ================= MAIN FLOURISH ================= */

    .flourish-container {
      width: 100%;
      position: relative;
    }

    .flourish-container iframe {
      position: absolute;
      inset: 0;
      width: 100%;
      height: 100%;
      border: none;
    }

    @media (min-width: 768px) {
      .flourish-container {
        aspect-ratio: 1 / 1.25;
        max-width: 1000px;
        margin: 0 auto;
      }
    }

    @media (max-width: 767px) {
      .flourish-container {
        aspect-ratio: 1 / 1.6;
      }
    }

    /* ================= SECONDARY LAYOUT ================= */

    .secondary-container {
      max-width: 1000px;
      margin: 2rem auto;
      padding: 0 1rem;
    }

    .secondary-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 1.5rem;
    }

    @media (max-width: 767px), (orientation: portrait) {
      .secondary-grid {
        grid-template-columns: 1fr;
      }
    }

    .secondary-block {
      background: #f5f5f5;
      padding: 1rem;
      border-radius: 6px;
    }

    /* ================= BLOCK A: TAB SWITCHER ================= */

    .tab-container {
      display: flex;
      justify-content: center;
      margin-bottom: 1rem;
    }

    .tabs {
      position: relative;
      display: flex;
      background: #f2f5f9;
      border-radius: 40px;
      padding: 6px 10px;
      min-width: 260px;
    }

    .tab-btn {
      flex: 1;
      border: none;
      background: none;
      font-size: 1rem;
      font-weight: 500;
      cursor: pointer;
      z-index: 1;
    }

    .tab-btn.active {
      font-weight: 600;
    }

    .tab-indicator {
      position: absolute;
      inset: 6px;
      width: calc((100% - 20px) / 2);
      background: #fff;
      border-radius: 16px;
      transition: transform 0.35s cubic-bezier(0.25,1,0.3,1);
    }

    .tab-content {
      display: none;
    }

    .tab-content.active {
      display: block;
    }

    /* ================= BLOCK B: COALITION BUILDER ================= */

    .header-container {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1rem;
    }

    .tab-switcher {
      display: flex;
      position: relative;
      background: #eee;
      border-radius: 12px;
      overflow: hidden;
      height: 34px;
    }

    .tab-button {
      border: none;
      background: none;
      padding: 6px 12px;
      cursor: pointer;
      font-weight: bold;
      z-index: 1;
    }

    .tab-slider {
      position: absolute;
      inset: 0;
      width: 50%;
      background: #fff;
      border-radius: 12px;
      transition: transform 0.25s ease;
    }

    .legend {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      justify-content: center;
      margin-bottom: 1rem;
    }

    .legend-item {
      display: flex;
      gap: 6px;
      align-items: center;
      padding: 6px 10px;
      border-radius: 8px;
      border: 1px solid #ccc;
      cursor: pointer;
      opacity: 0.6;
    }

    .legend-item.active {
      opacity: 1;
      font-weight: bold;
      background: #fff;
    }

    .legend-box {
      width: 16px;
      height: 16px;
      border-radius: 4px;
    }

    .bar-container {
      position: relative;
      height: 120px;
      background: #eee;
      border-radius: 10px;
      overflow: hidden;
    }

    .coalition-overlay {
      display: flex;
      height: 100%;
      width: 0;
      transition: width 0.8s ease;
    }

    .segment {
      height: 100%;
    }

    .counter {
      text-align: center;
      font-weight: bold;
      margin-top: 0.5rem;
    }
  </style>
</head>

<body>

  <!-- MAIN -->
  <div class="flourish-container">
    <iframe src="https://flo.uri.sh/visualisation/26950934/embed"></iframe>
  </div>

  <!-- SECONDARY -->
  <div class="secondary-container">
    <div class="secondary-grid">

      <!-- BLOCK A -->
      <div class="secondary-block">
        <div class="tab-container">
          <div class="tabs">
            <div class="tab-indicator"></div>
            <button class="tab-btn active" data-tab="votes">Votes</button>
            <button class="tab-btn" data-tab="seats">Seats</button>
          </div>
        </div>

        <div id="votes" class="tab-content active">
          <div class="flourish-embed" data-src="visualisation/24560280"></div>
        </div>

        <div id="seats" class="tab-content">
          <div class="flourish-embed" data-src="visualisation/24560334"></div>
        </div>
      </div>

      <!-- BLOCK B -->
      <div class="secondary-block">
        <div class="header-container">
          <h3>Coalition Builder</h3>
          <div class="tab-switcher">
            <div class="tab-slider" id="slider"></div>
            <button class="tab-button active" onclick="switchTab(0)">Nowcast</button>
            <button class="tab-button" onclick="switchTab(1)">2021</button>
          </div>
        </div>

        <div class="legend" id="legend"></div>
        <div class="bar-container">
          <div class="coalition-overlay" id="overlay"></div>
        </div>
        <div class="counter" id="counter">0 / 129</div>
      </div>

    </div>
  </div>

<script src="https://public.flourish.studio/resources/embed.js"></script>

<script>
  /* Tab switcher (Block A) */
  const tabs = document.querySelectorAll(".tab-btn");
  const contents = document.querySelectorAll(".tab-content");
  const indicator = document.querySelector(".tab-indicator");

  tabs.forEach((btn, i) => {
    btn.onclick = () => {
      tabs.forEach(b => b.classList.remove("active"));
      contents.forEach(c => c.classList.remove("active"));
      btn.classList.add("active");
      document.getElementById(btn.dataset.tab).classList.add("active");
      indicator.style.transform = `translateX(${i * 100}%)`;
    };
  });

  /* Coalition builder (Block B) */
  const data = [
    [{n:"A",s:40,c:"#f00"},{n:"B",s:30,c:"#0f0"}],
    [{n:"A",s:35,c:"#f00"},{n:"B",s:20,c:"#0f0"}]
  ];

  let selected = [], tab = 0;
  const legend = document.getElementById("legend");
  const overlay = document.getElementById("overlay");
  const counter = document.getElementById("counter");
  const slider = document.getElementById("slider");

  function switchTab(i){
    tab=i;
    slider.style.transform=`translateX(${i*100}%)`;
    render();
  }

  function render(){
    legend.innerHTML="";
    overlay.innerHTML="";
    let total=0;

    data[tab].forEach(p=>{
      const el=document.createElement("div");
      el.className="legend-item";
      el.innerHTML=`<div class="legend-box" style="background:${p.c}"></div>${p.n}`;
      el.onclick=()=>{selected.includes(p)?selected=[]:selected=[p];render()};
      legend.appendChild(el);
      if(selected.includes(p)) total+=p.s;
    });

    overlay.style.width=(total/129*100)+"%";
    counter.textContent=`${total} / 129`;
  }
  render();
</script>

</body>
</html>
